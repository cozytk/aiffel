### 목표

- 추천시스템의 개념과 목적
- Implicit 라이브러리를 활용하여 **Matrix Factorization**(이하 MF) 기반의 추천 모델을 만들어 본다.
- 음악 감상 기록을 활용하여 비슷한 아티스트를 찾고 아티스트를 추천해 본다.
- 추천 시스템에서 자주 사용되는 데이터 구조인 **CSR Matrix**을 익힌다 유저의 행위 데이터 중 Explicit data와 Implicit data의 차이점을 익힌다.
- 새로운 데이터셋으로 직접 추천 모델을 만들어 본다.

## 콘텐츠 추천 알고리즘의 진화

### 협업 필터링

*다수의 사용자의 아이템 구매 이력 정보만으로 사용자간 유사성 및 아이템 간 유서상 파악*

→ 아이템과 사용자 간의 **행동 또는 관계**에만 주목

**제약 조건**

1. Cold Start(콜드 스타트) 상황
    
    : 시스템이 충분한 정보를 모으지 못한 아이템에 대한 추론을 할 수 없는 상태
    
2. 계산량이 너무 많아 추천 효율 떨어짐
3. 롱테일의 꼬리 부분, 즉 사용자의 관심이 저조한 항목의 정보가 부족하여 추천에서 배제

### **콘텐츠 기반 필터링**

*아이템의 고유의 정보를 바탕으로 아이템 간 유사성을 파악*

→ **아이템 자체의 속성**에만 주목

**초기 정보 입력 요구 이유**

→ 콘텐츠 기반 필터링이 아닌 처음부터 **사용자 특성에 따른 맞춤 서비스 제공** 위하여.

필터 버블 문제 예방과 추천의 다양성을 살림

## 추천 시스템

### 사용

1. 아이템이 매우 많음
2. 유저의 취향이 다양

### 사례

- 유튜브, 페이스북, 아마존

## 명시적/암묵적 평가

**명시적 평가**

- 좋아요, 별점

**암묵적 평가**

- 플레이 횟수, 플레이 시간, 클릭 수, 구매 여부, ...

Q. 한 번 들은 노래는 추천해야하나 말아야하나?

→ 도메인 지식과 직관.

## Matrix Factorization

### 평가행렬

mxn의 평가행렬을 만들거임

ex) m명의 사용자들과 n명의 아티스트

행렬 중 일부는 데이터가 채워져 있지만, 나머지 부분은 데이터가 비어 있음

추천시스템의 협업 필터링은 이런 평가행렬을 전제로 함

## MF 모델

(m,n) 사이즈의 행렬 R을 (m,k) 사이즈 행렬 P와 (k,n) 사이즈 행렬 Q로 분해

**장점**

- 성능이 준수
- Scalability가 좋음

![스크린샷 2021-10-26 오전 11.32.47.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fd26ec8f-df72-47e4-bada-cb1caa0718a3/스크린샷_2021-10-26_오전_11.32.47.png)

행렬 P의 첫 행이 첫번째 사용자에 해당, 행렬 Q의 첫 열이 첫번째 작품에 해당

![스크린샷 2021-10-26 오전 11.37.41.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/45da5013-a2ea-4427-8f0e-bb14c31aa46b/스크린샷_2021-10-26_오전_11.37.41.png)

## CSR(Compressed Sparse Row) Matrix

유저 X 아이템 평가행렬

**Sparse Matrix**

대부분의 공간이 0으로 채워지는 행렬

### CSR Matrix

Sparse한 matrix에서 **0이 아닌 유효한 데이터로 채워지는 데이터의 값**과 **좌표 정보**만으로 구성. 메모리 사용량을 최소화, Sparse한 matrix와 동일한 행렬을 표현.

![스크린샷 2021-10-26 오후 12.03.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a2e53e79-d6c1-406b-9faf-8cd60fa305be/스크린샷_2021-10-26_오후_12.03.20.png)

- indptr은 각 행의 원소들의 누적 느낌

## als(AlternatingLeastSquares) 모델

- implicit (암묵적 데이터셋) 라이브러리에 있는 Matrix Factorization 모델 패키지
- 두 Feature Matrix를 한꺼번에 훈련하는 것은 잘 수렴하지 않음
- 따라서, 한 쪽을 고정시키고 다른 쪽을 학습시키는 방식